## 本章目标
- 
- 

## 关键概念
- OS：中间人


## 关键图/流程（可配图）
- 

## 代码/命令（可复制运行）
```bash```
## notes
计算机系统的硬件结构：

<img width="421" height="383" alt="image" src="https://github.com/user-attachments/assets/b5e0a61d-9e4f-4289-8886-b01b8588edc3" />


计算机系统运行时的步骤：
1. 外界（网络适配器）或计算机本身的输入设备，向计算机发起请求。
2. 请求去读取内存中应该执行的命令，在CPU上执行，并将执行结果，写入负责保存数据的内存。
3. 再将内存中的数据写入存储器（HDD，SDD等），或通过网络发给别的计算机，或者通过输出设备，输出给使用计算机的人。
4. 回到步骤一。

以上步骤进行整合，就是程序。

程序有：
1. 应用程序
2. 中间件（通用，比如数据库等）
3. OS（如：Linux）

通常情况下，程序在OS上以进程为单位运行。每个程序由一个或者多个进程构成。

Linux的主要功能：调用外部设备。如果没有Linux在中间协调，每个程序都必须额外包含一套调用外部设备的代码。如图所示：

<img width="423" height="208" alt="image" src="https://github.com/user-attachments/assets/4e9a0cf7-1b0d-4857-b00d-ebeb8ccea182" />


---

为解决这个痛点，Linux便有了一个叫做“设备驱动程序”的程序。

<img width="424" height="210" alt="image" src="https://github.com/user-attachments/assets/86d9f8de-80cc-4a2c-9817-0d1fd2f9a019" />
---

但这样还不够安全，外部设备必须严格控制访问权限，CPU有用户模式和内核模式，分别代表了不同的权限。
- 让设备驱动程序在内核模式下运行
- 让进程在用户模式下运行

还有很多程序，普通进程不能调用：
- 进程管理系统
- 进程调度器
- 内存管理系统

以上这些程序，也会在内核模式下运行。如果进程真的想使用内核模式，那就向**系统调用**特殊申请后向内核发出请求。

<img width="942" height="432" alt="image" src="https://github.com/user-attachments/assets/e3fc2801-641e-4184-a856-12c2de49282c" />

---

内核负责管理计算机系统上的CPU和内存等各种资源，然后把这些资源按需分配给在系统上运行的各个进程。

<img width="420" height="370" alt="image" src="https://github.com/user-attachments/assets/23ca3f52-c464-490c-9662-e85485031f0a" />




